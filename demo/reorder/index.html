<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>dompatch demo</title>
	<style type="text/css">
		.on { background: black; color: white; }
		.off { background: white; color: black; }
		textarea {
			width: 300px;
			height: 150px;
			font-size: 300%;
		}
	</style>
</head>
<body>

<script src="../../dist/dompatch.js"></script>

<script>
function template() {
	return (
		'<title>' + (new Date).toLocaleString() + '</title>' +
		'<ol>' +
			'<li>' + Math.round(frames / ((performance.now() - start) / 1000)) + ' fps</li>' +
			'<li>&copy; ' + (Math.random() + 1994) + '</li>' +
		(Math.random() < 0.05 ? '<li id="random">' + Math.random() + '</li>' : '') +
		'<li id="edit"><textarea></textarea></li>' +
		(Math.random() < 0.33 ? '<li id="boo">boo!</li>' : '')
	);
}

function update() {
	var s = performance.now();
	var html = template();
	
	var dom = new DOMParser().parseFromString(html, 'text/html');
	dompatch(document, dom, {
		compare: lastDom,
		shouldUpdate: function  (element, name, value) {
			if (element.nodeName === 'TEXTAREA') {
				return false;
			}
			return true;
		}
	});

	lastDom = dom;
	frames++;
	//console.log(//'fast?', performance.now() - s, 'ms', 
		//);
}
var frames = 0,
	start = performance.now(),
	lastDom;


setInterval(function () {
	update();
}, 10);

update();

document.querySelector('textarea').focus();
</script>

</body>
</html>